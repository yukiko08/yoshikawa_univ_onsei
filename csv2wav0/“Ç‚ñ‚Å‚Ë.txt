
■はじめに
  本プログラム群は、音声データとして一般的なWAVEファイルと、CSVファイル
(TEXTファイル:カンマで数値が区切られている形式)との相互変換プログラムが
収録されてます。 また、WAVEファイルではなく純粋なバイナリ形式に変換する
プログラムも収録されています。
  本当はデータをDATに記録する目的でcsv<-->bin, bin<-->csv作ったのですが
WAVEファイルを扱えた方が一般の人には便利だと思って、 こちらも収録しまし
た。

収録した実行ファイルは Windows95 DOSコンソール用の実行ファイルです。なる
べく速度を重視したかったのでPentium Pro,Pentium用の差分(自己アップデート
形式)を付けました。それぞれppro.com, pp5.comのいずれかを実行すれば、
Pentium Pro,Pentium用の実行ファイルが作成されます。



■同梱ファイル

ppro.com    Pentium Pro用差分ファイル
pp5.com     Pentium用差分ファイル

wav2csv.exe WAVEファイルをcsv形式のテキストデータに変換します。
wav2csv.c   

csv2wav.exe csv形式のテキストデータをWAVEファイルに変換します。
csv2wav.c   

csv2bin.exe csv形式のテキストデータをバイナリファイルに変換します。
csv2bin.c   

bin2csv.exe バイナリファイルをcsv形式のテキストデータに変換します。
bin2csv.c   

convo.exe   直線畳み込み演算
convo.c     

dct.exe     DCTを用いた補完・間引きを行います。
dct.c       

mread.h     CSV形式のデータの読み込み書き込みルーチン
getopt.h    コマンドラインオプション処理ルーチン
flag.h      フラグ制御
dct.h       DCT,IDCT
darray.h    配列操作ルーチン
dalloc.h    メモリ確保



■コンパイル方法
本アーカイブに添付されたソース コードをコンパイルするにあたって注意する
点がいくつかあります。

添付されたソースはintが4byteで表現されるコンパイラを前提としています。 
市販の16bitコンパイラでもコンパイルは通るとは思いますが、正しく動作しな
いでしょう。
上記の条件を満たしていれば大丈夫ですが、市販の32bitコンパイラで試したわ
けではないので保証はできませんが(^^;。ただしbcc32.exeについては確認いた
しました。

また、 本プログラムは、メモリの量のことなどまったくおかまいなしに好きな
だけアロケートするので(実行時にチェックはします)、 数メガ程度のメモリ空
間を扱えることも条件となります。

最も最適なコンパイラとしてはgccをお勧めします。またボーランド製のコンパ
イラも吉です。こちらは最適化することにより高速に動作します。


■使用方法
○csvファイルのデータ形式について
  csvファイルは簡単なフォーマットがあります。といっても最初の行にデータ
数を書くことだけです。動的に付け足しながらアロケートすると、 音声信号処
理の場合においてはデータ数が半端な量ではないので効率が悪くなるため、 そ
うしています。
  データ数以上のデータは読み込まず、またデータ数に満たない場合は、 そこ
で打ち切ります。'#',';','*'が現われた場合は行末まで無視されます。同様に
空行も無視されます。 データの区切りはカンマ、スペース、タブが使用できま
す。

○入力ファイルの指定について
  csv2wav.exe等はcsvファイルを入力ファイルとして指定します。 このとき次
のようなtest.datがあり２列目のデータをrightのデータとして指定したいとき
                          csv2wav -r test.dat,1
とします。同様に３列目なら
                          csv2wav -r test.dat,2
となります。０からはじまっているので注意して下さい。
                          csv2wav -r test.dat
上記のように列を指定しない場合は "-r test.dat,1" となります。
----- test.dat -----
4
1.1 , 53.3 , 45.35
2.5 , 1.02 , 123.78
5.3 , 23.7 , 45.46
7.8 , 5.65 , 36.78
--------------------
0     1      2 <---column

○コマンドラインオプション
  プログラムのオプションは順不同で構いません。


■コマンドラインオプション

◆csv2wav.exe ：csv形式のテキストデータをWAVEファイルに変換します。

  /o filename
        出力するWAVEファイルのファイル名を指定します。

  /r filename,column(integer)
        rightへ入力するCSV形式のデータファイルのファイル名を指定します。
        /rだけ指定すると、モノラルになります。
        ステレオにする場合は/lも指定して下さい。
        columnは読み込む列です(０からはじまります)。
        columnを指定しない場合はcolumn=1となります。

  /f value(integer)
        サンプリング周波数を指定します。
        WAVEファイルは11025,22050,44100Hzから選択できます。


  必要な場合は指定して下さい。指定しない場合はデフォルトの値を使用します。
  /l filename,column(integer)
        leftへ入力するCSV形式のデータファイルのファイル名を指定します。
        columnは読み込む列です(０からはじまります)。
        columnを指定しない場合はcolumn=1となります。

  /n value(integer)
        読み込んだデータをvalue回繰り返します。
        デフォルト値は1です。

  /b value(integer)
        量子化ビット数です。8,16を指定します。
        デフォルト値は16bitです。

  /v value(double)
        プログラムはデータの最大値でデータを正規化します。
        振幅の最大値を絞りたい場合は、このオプションで調節します。
        デフォルト値は1.0です。



◆csv2bin.exe ：csv形式のテキストデータをバイナリファイルに変換します。

  /fオプションがないだけで、あとはcsv2wav.exeと同じです。



◆wav2csv.exe ：WAVEファイルをcsv形式のテキストデータに変換します。

  /i filename
        入力するWAVEファイルのファイル名を指定します。

  /o filename
        出力するCSVファイルのファイル名を指定します。


  必要な場合は指定して下さい。指定しない場合はデフォルトの値を使用します。
  /s value(bool)
        WAVEファイルの量子化ビット数が８ビットの場合に0〜255の値で書き込む
        か-128〜127の値で書き込むか指定します。
        valueが0でない(true)なら-128〜128です。
        valueが0(false)なら0〜255です。
        デフォルト値はtrue(-128〜128)です。

  /c value(bool)
        出力ファイルにWAVEファイルのデータを書き込むかどうかを指定します。
        valueが0でない(true)なら書き込みます。
        valueが0(false)なら書き込みません。
        デフォルト値はfalse(書き込まない)です。

  /d value(bool)
        WAVEファイルの詳細な情報を表示するかどうかを指定します。
        valueが0でない(true)なら表示します。
        valueが0(false)なら表示しません。
        デフォルト値はfalse(表示しない)です。



◆bin2csv.exe ：バイナリファイルをcsv形式のテキストデータに変換します。

  /i filename
        入力するWAVEファイルのファイル名を指定します。

  /o filename
        出力するCSVファイルのファイル名を指定します。

  /b value
        量子化ビット数を指定します。
        データに合わせて16または8を指定します。

  /c value
        チャンネル数(モノラル・ステレオ)を指定します。
        データに合わせて、モノラルなら１、ステレオなら２を指定します。


  必要な場合は指定して下さい。指定しない場合はデフォルトの値を使用します。
  /s value(bool)
        WAVEファイルの量子化ビット数が８ビットの場合に0〜255の値で書き込む
        か-128〜127の値で書き込むか指定します。
        valueが0でない(true)なら-128〜128です。
        valueが0(false)なら0〜255です。
        デフォルト値はtrue(-128〜128)です。



◆dct.exe ：DCTを用いた補完・間引きを行います。
        サンプリングレートの変換としても利用でき、アンダーサンプリ
        ングによるエイリアスや、オーバーサンプリングによる高域成分
        の発生を劇的に押さえられます。

  /i filename,column(integer)
        入力するCSVファイルのファイル名を指定します。
        columnは読み込む列です(０からはじまります)。
        columnを指定しない場合はcolumn=1となります。

  /o filename
        出力するCSVファイルのファイル名を指定します。

  /b block size(integer)
        1ブロックサイズを指定します。

  /r value(double)
        入力ファイルのデータ数のvalue倍になるように補完、または間引き
        を行います。


◆convo.exe ：直線畳み込み演算

  /x filename,column(integer)
        入力信号xのデータを指定します。
        入力するCSV形式のデータファイルのファイル名を指定します。
        columnは読み込む列です(０からはじまります)。
        columnを指定しない場合はcolumn=1となります。

  /h filename,column(integer)
        フィルタ係数となるデータを指定します。
        入力するCSV形式のデータファイルのファイル名を指定します。
        columnは読み込む列です(０からはじまります)。
        columnを指定しない場合はcolumn=1となります。

  /y filename
        出力するCSVファイルのファイル名を指定します。


■おわりに

本プログラム群はフリーソフトです。できる限りのテストは行ってはいますが、
万一、本プログラム群及び添付ソースを用いてコンパイルして作成された実行フ
ァイルによって、利用者がいかなる損害を被っても、作者は一切の責任を負わな
いものとします。

これらを守って頂ければ、金銭が絡まない限り、ソース及びプログラムは自由に
使って構いません。

e-mail: hayano@mars.dti.ne.jp

